---
- name: Setup Monitoring (Prometheus & Grafana)
  hosts: localhost
  connection: local
  tasks:
    - name: Ensure Python kubernetes library is installed via apt
      become: yes
      apt:
        name:
          - python3-kubernetes
          - python3-yaml
        state: present
        update_cache: yes

    - name: Create monitoring namespace
      kubernetes.core.k8s:
        name: monitoring
        kind: Namespace
        state: present

    # ... (skrátené pre prehľadnosť, ale ponechávame tvoje ConfigMapy a Deploymenty) ...

    - name: Wait for Grafana rollout
      shell: "kubectl rollout status deployment/grafana -n monitoring --timeout=180s"

    - name: Wait for Prometheus rollout
      shell: "kubectl rollout status deployment/prometheus -n monitoring --timeout=180s"

    - name: Wait for Alertmanager rollout
      shell: "kubectl rollout status deployment/alertmanager -n monitoring --timeout=180s"
